# æ•°æ®è„±æ•å·¥å…·
æºè‡ª
https://juejin.cn/post/7225218026097852472

### ******ğŸ˜¼å¼€å§‹******

******

æœ¬æ–‡ä¸»è¦åˆ†äº«ä»€ä¹ˆæ˜¯æ•°æ®è„±æ•ï¼Œå¦‚ä½•ä¼˜é›…çš„åœ¨é¡¹ç›®ä¸­è¿ç”¨ä¸€ä¸ªæ³¨è§£å®ç°æ•°æ®è„±æ•ï¼Œä¸ºé¡¹ç›®è¿›è¡Œèµ‹èƒ½ã€‚å¸Œæœ›èƒ½ç»™ä½ ä»¬å¸¦æ¥å¸®åŠ©ã€‚ğŸ˜€

### â“ä»€ä¹ˆæ˜¯æ•°æ®è„±æ•

æ•°æ®è„±æ•æ˜¯ä¸€ç§é€šè¿‡å»é™¤æˆ–æ›¿æ¢æ•æ„Ÿæ•°æ®ä¸­çš„éƒ¨åˆ†ä¿¡æ¯ï¼Œä»¥ä¿æŠ¤æ•°æ®éšç§å’Œå®‰å…¨çš„æŠ€æœ¯ã€‚å…¶ä¸»è¦ç›®çš„æ˜¯ç¡®ä¿æ•°æ®ä»ç„¶å¯ä»¥åœ¨å„ç§åœºæ™¯ä¸­ä½¿ç”¨ï¼ŒåŒæ—¶ä¿æŠ¤æ•æ„Ÿä¿¡æ¯ï¼Œé˜²æ­¢æ•°æ®æ³„éœ²å’Œæ»¥ç”¨ã€‚æ•°æ®è„±æ•é€šå¸¸ç”¨äºå¤„ç†åŒ…å«ä¸ªäººèº«ä»½ä¿¡æ¯å’Œå…¶ä»–æ•æ„Ÿä¿¡æ¯çš„æ•°æ®é›†ï¼Œå¦‚æ‰‹æœºå·ã€å§“åã€åœ°å€ã€é“¶è¡Œå¡ã€èº«ä»½è¯å·ã€è½¦ç‰Œå·ç­‰ç­‰ã€‚

åœ¨æ•°æ®è„±æ•è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸ä¼šé‡‡ç”¨ä¸åŒçš„ç®—æ³•å’ŒæŠ€æœ¯ï¼Œä»¥æ ¹æ®ä¸åŒçš„éœ€æ±‚å’Œåœºæ™¯å¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€‚ä¾‹å¦‚ï¼Œå¯¹äºèº«ä»½è¯å·ç ï¼Œå¯ä»¥ä½¿ç”¨æ©ç ç®—æ³•ï¼ˆmaskingï¼‰å°†å‰å‡ ä½æ•°å­—ä¿ç•™ï¼Œå…¶ä»–ä½ç”¨â€œXâ€æˆ–"\*"ä»£æ›¿ï¼›å¯¹äºå§“åï¼Œå¯ä»¥ä½¿ç”¨ä¼ªé€ ï¼ˆpseudonymizationï¼‰ç®—æ³•ï¼Œå°†çœŸå®å§“åæ›¿æ¢æˆéšæœºç”Ÿæˆçš„å‡åã€‚

ä¸‹é¢æˆ‘è®²ä¸ºå¤§å®¶å¸¦æ¥æ•°æ®è„±æ•æ©ç æ“ä½œï¼Œè®©æˆ‘ä»¬ä¸€èµ·å­¦èµ·æ¥å§ã€‚ğŸ®

### â—å¼€èƒƒèœ

ä¸‹é¢ç»™å¤§å®¶ä»‹ç»çš„æ˜¯ä½¿ç”¨ä¸¤ç§ä¸åŒçš„å·¥å…·ç±»è¿›è¡Œæ•°æ®è„±æ•ï¼Œè€Œæˆ‘ä»¬ä»Šå¤©çš„ä¸»é¢˜ä½¿ç”¨ä¸€ä¸ªæ³¨è§£è§£å†³æ•°æ®è„±æ•é—®é¢˜çš„ä¸»è¦ä¸¤ä¸ªå·¥å…·ç±»ã€‚æ¥è·Ÿç€æˆ‘å­¦ä¹ å§ã€‚ğŸ˜¼

#### ä½¿ç”¨Hutoolå·¥å…·ç±»å®ç°æ•°æ®æ©ç 

æ¯”å–»è¯´æˆ‘ä»¬ç°åœ¨è¦å¯¹æ‰‹æœºå·è¿›è¡Œæ•°æ®è„±æ•ï¼Œ**å‰ä¸‰åå››ä¸æ©ç ï¼Œå…¶ä»–å…¨éƒ¨ç”¨\*è¿›è¡Œæ©ç **

å¦‚ä¸‹å›¾ä»£ç æ‰€ç¤ºï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ‰‹æœºå·ï¼š17677772345ï¼Œéœ€è¦è¿›è¡Œæ•°æ®è„±æ•ã€‚

è°ƒç”¨çš„hutoolçš„ä¿¡æ¯è„±æ•å·¥å…·ç±»ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/23c1063447df4ab7a0d4266fb34130d3~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

æˆ‘ä»¬è¿è¡Œä¸€ä¸‹çœ‹çœ‹ç»“æœã€‚ä¸€ä¸ªç®€å•çš„æ•°æ®è„±æ•å°±å®ç°äº†ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bd478aefcd794af4863a6968eb1b0853~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

##### Hutoolä¿¡æ¯è„±æ•å·¥å…·ç±»

æ ¹æ®ä¸Šé¢çš„ä¸€ä¸ªDemoï¼Œå¤§å®¶å¯ä»¥çœ‹åˆ°æˆ‘ä½¿ç”¨äº†Hutoolçš„ä¿¡æ¯è„±æ•å·¥å…·ç±»è¿›è¡Œå¯¹æ‰‹æœºå·æ©ç è„±æ•ã€‚é‚£ä¹ˆè®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹Hutoolä¿¡æ¯è„±æ•çš„å·¥å…·ç±»å§ã€‚

å®˜ç½‘æ–‡æ¡£ï¼š

[hutool.cn/docs/#/coreâ€¦](https://link.juejin.cn/?target=https%3A%2F%2Fhutool.cn%2Fdocs%2F%23%2Fcore%2F%25E5%25B7%25A5%25E5%2585%25B7%25E7%25B1%25BB%2F%25E4%25BF%25A1%25E6%2581%25AF%25E8%2584%25B1%25E6%2595%258F%25E5%25B7%25A5%25E5%2585%25B7-DesensitizedUtil "https://hutool.cn/docs/#/core/%E5%B7%A5%E5%85%B7%E7%B1%BB/%E4%BF%A1%E6%81%AF%E8%84%B1%E6%95%8F%E5%B7%A5%E5%85%B7-DesensitizedUtil")

çœ‹ä¸€ä¸‹å®˜ç½‘çš„ä»‹ç»ï¼Œæ”¯æŒå¤šç§è„±æ•æ•°æ®ç±»å‹ï¼Œæ»¡è¶³æˆ‘ä»¬å¤§éƒ¨åˆ†éœ€æ±‚ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰è¿˜æä¾›äº†è‡ªå®šä¹‰çš„æ–¹æ³•å®ç°ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/794a96fabaa24603a007932fa542b60a~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

ä¸‹é¢æ˜¯é‡Œé¢å®šä¹‰å·çš„è„±æ•è§„åˆ™ï¼Œç›´æ¥è°ƒç”¨å°±å¯ä»¥å®ç°ç®€å•çš„æ•°æ®è„±æ•ï¼Œè¿™é‡Œç»™å¤§å®¶ä»‹ç»æ˜¯å› ä¸ºæˆ‘ä»¬ä»Šå¤©è¦ç»™å¤§å®¶å¸¦æ¥çš„æ³¨è§£å®ç°æ•°æ®è„±æ•æ ¸å¿ƒå°±æ˜¯åˆ©ç”¨æˆ‘ä»¬çš„Hutoolæä¾›çš„å·¥å…·ç±»å®ç°ï¼Œæ”¯æŒè‡ªå®šä¹‰éšè—ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ab83fd7b7e7541158f9201b8e30d5909~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

#### ä½¿ç”¨Jacksonè¿›è¡Œæ•°æ®åºåˆ—åŒ–è„±æ•

é¦–å…ˆåˆ›å»ºä¸€ä¸ªå®ä½“ç±»ï¼Œæ­¤å®ä½“ç±»åªæœ‰ä¸€ä¸ªæµ‹è¯•çš„æ‰‹æœºå·ã€‚

æ³¨è§£çš„è®²è§£ï¼š

@Dataï¼šlombokçš„æ³¨è§£ç”Ÿæˆget,setç­‰ç­‰æ–¹æ³•ã€‚

@JsonSerialize(using = TestJacksonSerialize.class)ï¼š**è¯¥æ³¨è§£çš„ä½œç”¨å°±æ˜¯å¯è‡ªå®šä¹‰åºåˆ—åŒ–ï¼Œå¯ä»¥ç”¨åœ¨æ³¨è§£ä¸Šï¼Œæ–¹æ³•ä¸Šï¼Œå­—æ®µä¸Šï¼Œç±»ä¸Šï¼Œè¿è¡Œæ—¶ç”Ÿæ•ˆç­‰ç­‰ï¼Œæ ¹æ®æä¾›çš„åºåˆ—åŒ–ç±»é‡Œé¢çš„é‡å†™æ–¹æ³•å®ç°è‡ªå®šä¹‰åºåˆ—åŒ–ã€‚å¯ä»¥çœ‹ä¸‹ä¸‹é¢çš„æºç ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥å»äº†è§£ä¸€ä¸‹ï¼Œä¹Ÿèƒ½è§£å†³æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­å¾ˆå¤šåœºæ™¯ã€‚** ğŸˆ

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/419e30ccddea4bdb99f7635ede410892~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

```ruby
@Data public class TestDTO implements Serializable { /** * æ‰‹æœºå· */ @JsonSerialize(using = TestJacksonSerialize.class) private String phone; }
```

ç„¶ååˆ›å»ºä¸€ä¸ªTestJacksonSerializeç±»å®ç°è‡ªå®šä¹‰åºåˆ—åŒ–ã€‚

æ­¤ç±»ä¸»è¦ç»§æ‰¿JsonSerializerï¼Œå› ä¸ºæˆ‘ä»¬è¿™é‡Œéœ€è¦åºåˆ—åŒ–çš„ç±»å‹æ˜¯Stringæ³›å‹å°±é€‰æ‹©Stringã€‚**æ³¨æ„å¦‚æœä½ ä½¿ç”¨æ­¤æ³¨è§£ä½œç”¨åœ¨ç±»ä¸Šçš„è¯ï¼Œè¿™é‡Œå°±æ˜¯ä½ è¦åºåˆ—åŒ–çš„ç±»ã€‚**

é‡å†™åºåˆ—åŒ–æ–¹æ³•ï¼Œé‡Œé¢çš„å®ç°å¾ˆç®€å•å°±æ˜¯è°ƒç”¨æˆ‘ä»¬çš„hutoolå·¥å…·ç±»è¿›è¡Œæ‰‹æœºå·æ•°æ®è„±æ•ã€‚

```less
public class TestJacksonSerialize extends JsonSerializer<String> { @Override @SneakyThrows public void serialize(String str, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) { // ä½¿ç”¨æˆ‘ä»¬çš„hutoolå·¥å…·ç±»è¿›è¡Œæ‰‹æœºå·è„±æ• jsonGenerator.writeString(DesensitizedUtil.fixedPhone(String.valueOf(str))); } }
```

è®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹å§ï¼Œå› ä¸ºæ­¤æ³¨è§£æ˜¯è¿è¡Œæ—¶ç”Ÿæ•ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ¥å£æ¥æµ‹è¯•ã€‚ğŸ„

```less
@RestController @RequestMapping("/test") public class TestApi { @GetMapping public TestDTO test(){ TestDTO testDTO = new TestDTO(); testDTO.setPhone("17677772345"); return testDTO; } }
```

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fff8edbbf49342e3bdde22888101028c~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

å¯ä»¥çœ‹åˆ°æµ‹è¯•æˆåŠŸï¼Œç»è¿‡ä¸Šé¢çš„ä¸¤ä¸ªå·¥å…·ç±»çš„ä»‹ç»ï¼Œè”æƒ³ä¸€ä¸‹æˆ‘ä»¬æ€ä¹ˆé€šè¿‡ä¸¤ä¸ªå·¥å…·ç±»å®šä¹‰ä¸€ä¸ªè‡ªå·±çš„æ³¨è§£å®ç°æ•°æ®è„±æ•å‘¢â“

### ğŸæ³¨è§£å®ç°æ•°æ®è„±æ•

**æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹ï¼Œå·¥å…·ç±»ç°åœ¨æœ‰äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆå»å®ç°ä¸€ä¸ªæ³¨è§£ä¼˜é›…çš„è§£å†³æ•°æ®è„±æ•å‘¢ï¼Ÿ**

è¯·çœ‹ä¸‹æ–‡ï¼Œè®©æˆ‘å¸¦å¤§å®¶ä¸€èµ·å­¦ä¹ ã€‚ğŸ•¹ï¸

#### 1ï¸âƒ£å®šä¹‰ä¸€ä¸ªæ³¨è§£

å®šä¹‰ä¸€ä¸ªDesensitizationæ³¨è§£ã€‚

@Retention(RetentionPolicy.RUNTIME)ï¼šè¿è¡Œæ—¶ç”Ÿæ•ˆã€‚

@Target(ElementType.FIELD)ï¼šå¯ç”¨åœ¨å­—æ®µä¸Šã€‚

@JacksonAnnotationsInsideï¼šæ­¤æ³¨è§£å¯ä»¥ç‚¹è¿›å»çœ‹ä¸€ä¸‹æ˜¯ä¸€ä¸ªå…ƒæ³¨è§£ï¼Œä¸»è¦æ˜¯ç”¨æˆ·æ‰“åŒ…å…¶ä»–æ³¨è§£ä¸€èµ·ä½¿ç”¨ã€‚

@JsonSerializeï¼šä¸Šé¢è¯´åˆ°è¿‡ï¼Œ**è¯¥æ³¨è§£çš„ä½œç”¨å°±æ˜¯å¯è‡ªå®šä¹‰åºåˆ—åŒ–ï¼Œå¯ä»¥ç”¨åœ¨æ³¨è§£ä¸Šï¼Œæ–¹æ³•ä¸Šï¼Œå­—æ®µä¸Šï¼Œç±»ä¸Šï¼Œè¿è¡Œæ—¶ç”Ÿæ•ˆç­‰ç­‰ï¼Œæ ¹æ®æä¾›çš„åºåˆ—åŒ–ç±»é‡Œé¢çš„é‡å†™æ–¹æ³•å®ç°è‡ªå®šä¹‰åºåˆ—åŒ–ã€‚**

```less
@Retention(RetentionPolicy.RUNTIME) @Target(ElementType.FIELD) @JacksonAnnotationsInside @JsonSerialize(using = DesensitizationSerialize.class) public @interface Desensitization { /** * è„±æ•æ•°æ®ç±»å‹ï¼Œåªè¦åœ¨CUSTOMERçš„æ—¶å€™ï¼ŒstartIncludeå’ŒendExcludeç”Ÿæ•ˆ */ DesensitizationTypeEnum type() default DesensitizationTypeEnum.CUSTOMER; /** * å¼€å§‹ä½ç½®ï¼ˆåŒ…å«ï¼‰ */ int startInclude() default 0; /** * ç»“æŸä½ç½®ï¼ˆä¸åŒ…å«ï¼‰ */ int endExclude() default 0; }
```

å¯ä»¥çœ‹åˆ°æ­¤æ³¨è§£æœ‰ä¸‰ä¸ªå€¼ï¼Œä¸€ä¸ªæ˜¯æšä¸¾ç±»å®šä¹‰äº†æˆ‘ä»¬çš„è„±æ•æ•°æ®ç±»å‹ã€‚ä¸€ä¸ªå¼€å§‹ä½ç½®ï¼Œä¸€ä¸ªç»“æŸä½ç½®ã€‚

æšä¸¾ç±»å¾…ä¼šç»™å¤§å®¶è®²è§£ï¼Œå¦‚æœé€‰æ‹©äº†è‡ªå®šä¹‰ç±»å‹ï¼Œä¸‹é¢çš„å¼€å§‹ä½ç½®ï¼Œç»“æŸä½ç½®æ‰ç”Ÿæ•ˆã€‚

å¼€å§‹ç»“æŸä½ç½®æ˜¯æˆ‘ä»¬hutoolå·¥å…·æä¾›çš„è‡ªå®šä¹‰è„±æ•å®ç°éœ€è¦çš„å‚æ•°ã€‚__å¯ä»¥çœ‹æ­¤æ–¹æ³•ï¼Œéœ€è¦æå‡ºä¸€ç‚¹çš„æ˜¯æ­¤æ–¹æ³•ç¡¬ç¼–ç äº†æ©ç å€¼_ã€‚å¦‚æœæˆ‘ä»¬çš„åœºæ™¯éœ€è¦å…¶ä»–æ©ç å€¼çš„è¯å®ç°ä¹Ÿå¾ˆç®€å•ï¼ŒæŠŠhutoolçš„æºç æ‹·å‡ºæ¥ï¼Œä»£æ›¿ä»–çš„ç¡¬ç¼–ç _ï¼Œå°±å¯ä»¥å®ç°ï¼Œè¿™é‡Œå°±ä¸ç»™å¤§å®¶å¤šåºŸè¯äº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è¯„è®ºï¼Œç§èŠæˆ‘å™¢ï¼Œæˆ‘æ•™ä½ ä»¬æ€ä¹ˆå®ç°ã€‚\*\*

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/119fdb6c592448ef9e97c4c0d33ae700~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

#### 2ï¸âƒ£åˆ›å»ºä¸€ä¸ªæšä¸¾ç±»

æ­¤æšä¸¾ç±»æ˜¯æˆ‘ä»¬æ•°æ®è„±æ•çš„ç±»å‹ï¼ŒåŒ…æ‹¬äº†å¤§éƒ¨åˆ†åœºæ™¯ã€‚ä»¥åŠå¯ä»¥æ»¡è¶³æˆ‘ä»¬æ—¥å¸¸å¼€å‘å’¯ã€‚

```swift
public enum DesensitizationTypeEnum { //è‡ªå®šä¹‰ CUSTOMER, //ç”¨æˆ·id USER_ID, //ä¸­æ–‡å CHINESE_NAME, //èº«ä»½è¯å· ID_CARD, //åº§æœºå· FIXED_PHONE, //æ‰‹æœºå· MOBILE_PHONE, //åœ°å€ ADDRESS, //ç”µå­é‚®ä»¶ EMAIL, //å¯†ç  PASSWORD, //ä¸­å›½å¤§é™†è½¦ç‰Œï¼ŒåŒ…å«æ™®é€šè½¦è¾†ã€æ–°èƒ½æºè½¦è¾† CAR_LICENSE, //é“¶è¡Œå¡ BANK_CARD }
```

#### 3ï¸âƒ£åˆ›å»ºæˆ‘ä»¬çš„è‡ªå®šä¹‰åºåˆ—åŒ–ç±»

æ­¤ç±»æ˜¯æˆ‘ä»¬æ•°æ®è„±æ•çš„å…³é”®ã€‚ä¸»è¦æ˜¯ç»§æ‰¿äº†æˆ‘ä»¬çš„JsonSerializerï¼Œå®ç°äº†æˆ‘çš„ContextualSerializerã€‚é‡å†™äº†å®ƒä¿©çš„æ–¹æ³•ã€‚

@NoArgsConstructorï¼šLombokæ— å‚æ„é€ ç”Ÿæˆã€‚

@AllArgsConstructorï¼šLombokæœ‰å‚ç”Ÿæˆã€‚

ContextualSerializerï¼š**è¿™ä¸ªç±»æ˜¯åºåˆ—åŒ–ä¸Šä¸‹æ–‡ç±»ï¼Œä¸»è¦æ˜¯è§£å†³æˆ‘ä»¬è¿™ä¸ªåœ°æ–¹è·å–å­—æ®µçš„ä¸€äº›ä¿¡æ¯ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹æºç ï¼Œä»–çš„å®ç°ç±»æœ‰å¾ˆå¤šï¼ŒJacksonæä¾›çš„@JsonFormatæ³¨è§£ä¹Ÿæ˜¯å®ç°æ­¤ç±»ï¼Œè·å–å­—æ®µçš„ä¸€äº›ä¿¡æ¯è¿›è¡Œåºåˆ—åŒ–çš„ã€‚æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹ä¸€ä¸‹ï¼Œå¤šçœ‹æºç ï¼Œæ‰èƒ½å­¦åˆ°Jacksonçš„å®ç°æ–¹æ³•ï¼Œæ‰èƒ½æœ‰ä»Šå¤©æˆ‘ä»¬çš„å®ç°ã€‚**

ä¸¤ä¸ªé‡å†™çš„æ–¹æ³•è§£è¯»ï¼š

serializeï¼šé‡å†™ï¼Œå®ç°æˆ‘ä»¬çš„åºåˆ—åŒ–è‡ªå®šä¹‰ã€‚

createContextualï¼šåºåˆ—åŒ–ä¸Šä¸‹æ–‡æ–¹æ³•é‡å†™ï¼Œè·å–æˆ‘ä»¬çš„å­—æ®µä¸€äº›ä¿¡æ¯è¿›è¡Œåˆ¤æ–­ï¼Œç„¶åè¿”å›å®ä¾‹ã€‚å…·ä½“ä»£ç å¯ä»¥çœ‹ä¸‹é¢ä»£ç ï¼Œéƒ½æœ‰æ³¨é‡Šå™¢ã€‚

```scss
@NoArgsConstructor @AllArgsConstructor public class DesensitizationSerialize extends JsonSerializer<String> implements ContextualSerializer { private DesensitizationTypeEnum type; private Integer startInclude; private Integer endExclude; @Override public void serialize(String str, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException { switch (type) { // è‡ªå®šä¹‰ç±»å‹è„±æ• case CUSTOMER: jsonGenerator.writeString(CharSequenceUtil.hide(str,startInclude,endExclude)); break; // userIdè„±æ• case USER_ID: jsonGenerator.writeString(String.valueOf(DesensitizedUtil.userId())); break; // ä¸­æ–‡å§“åè„±æ• case CHINESE_NAME: jsonGenerator.writeString(DesensitizedUtil.chineseName(String.valueOf(str))); break; // èº«ä»½è¯è„±æ• case ID_CARD: jsonGenerator.writeString(DesensitizedUtil.idCardNum(String.valueOf(str), 1, 2)); break; // å›ºå®šç”µè¯è„±æ• case FIXED_PHONE: jsonGenerator.writeString(DesensitizedUtil.fixedPhone(String.valueOf(str))); break; // æ‰‹æœºå·è„±æ• case MOBILE_PHONE: jsonGenerator.writeString(DesensitizedUtil.mobilePhone(String.valueOf(str))); break; // åœ°å€è„±æ• case ADDRESS: jsonGenerator.writeString(DesensitizedUtil.address(String.valueOf(str), 8)); break; // é‚®ç®±è„±æ• case EMAIL: jsonGenerator.writeString(DesensitizedUtil.email(String.valueOf(str))); break; // å¯†ç è„±æ• case PASSWORD: jsonGenerator.writeString(DesensitizedUtil.password(String.valueOf(str))); break; // ä¸­å›½è½¦ç‰Œè„±æ• case CAR_LICENSE: jsonGenerator.writeString(DesensitizedUtil.carLicense(String.valueOf(str))); break; // é“¶è¡Œå¡è„±æ• case BANK_CARD: jsonGenerator.writeString(DesensitizedUtil.bankCard(String.valueOf(str))); break; default: } } @Override public JsonSerializer<?> createContextual(SerializerProvider serializerProvider, BeanProperty beanProperty) throws JsonMappingException { if (beanProperty != null) { // åˆ¤æ–­æ•°æ®ç±»å‹æ˜¯å¦ä¸ºStringç±»å‹ if (Objects.equals(beanProperty.getType().getRawClass(), String.class)) { // è·å–å®šä¹‰çš„æ³¨è§£ Desensitization desensitization = beanProperty.getAnnotation(Desensitization.class); // ä¸ºnull if (desensitization == null) { desensitization = beanProperty.getContextAnnotation(Desensitization.class); } // ä¸ä¸ºnull if (desensitization != null) { // åˆ›å»ºå®šä¹‰çš„åºåˆ—åŒ–ç±»çš„å®ä¾‹å¹¶ä¸”è¿”å›ï¼Œå…¥å‚ä¸ºæ³¨è§£å®šä¹‰çš„type,å¼€å§‹ä½ç½®ï¼Œç»“æŸä½ç½®ã€‚ return new DesensitizationSerialize(desensitization.type(), desensitization.startInclude(), desensitization.endExclude()); } } return serializerProvider.findValueSerializer(beanProperty.getType(), beanProperty); } return serializerProvider.findNullValueSerializer(null); } }
```

#### 4ï¸âƒ£æµ‹è¯•

åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ³¨è§£çš„DTOï¼Œæ­¤æµ‹è¯•å¦‚ä¸‹ã€‚

```typescript
@Data public class TestAnnotationDTO implements Serializable { /** * è‡ªå®šä¹‰ */ @Desensitization(type = DesensitizationTypeEnum.CUSTOMER,startInclude = 5,endExclude = 10) private String custom; /** * æ‰‹æœºå· */ @Desensitization(type = DesensitizationTypeEnum.MOBILE_PHONE) private String phone; /** * é‚®ç®± */ @Desensitization(type = DesensitizationTypeEnum.EMAIL) private String email; /** * èº«ä»½è¯ */ @Desensitization(type = DesensitizationTypeEnum.ID_CARD) private String idCard; }
```

æ–°å¢æµ‹è¯•æ¥å£

```java
@GetMapping("/test-annotation") public TestAnnotationDTO testAnnotation(){ TestAnnotationDTO testAnnotationDTO = new TestAnnotationDTO(); testAnnotationDTO.setPhone("17677772345"); testAnnotationDTO.setCustom("111111111111111111"); testAnnotationDTO.setEmail("1433926101@qq.com"); testAnnotationDTO.setIdCard("4444199810015555"); return testAnnotationDTO; }
```

**æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹æ•ˆæœã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå®Œç¾ï¼ï¼ï¼ï¼**

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7478b09630bb48139b23845a8153a0f6~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

### é¡¹ç›®pomæ–‡ä»¶

```xml
<?xml version="1.0" encoding="UTF-8"?> <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"> <modelVersion>4.0.0</modelVersion> <parent> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-parent</artifactId> <version>2.7.10</version> <relativePath/> <!-- lookup parent from repository --> </parent> <groupId>com.jiaqing</groupId> <artifactId>tool-desensitization</artifactId> <version>0.0.1-SNAPSHOT</version> <name>tool-desensitization</name> <description>æ•°æ®è„±æ•</description> <properties> <java.version>1.8</java.version> <hutool.version>5.8.5</hutool.version> </properties> <dependencies> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter</artifactId> </dependency> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-web</artifactId> </dependency> <dependency> <groupId>cn.hutool</groupId> <artifactId>hutool-core</artifactId> <version>${hutool.version}</version> </dependency> <dependency> <groupId>org.projectlombok</groupId> <artifactId>lombok</artifactId> <optional>true</optional> </dependency> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-test</artifactId> <scope>test</scope> </dependency> <!--jsonæ¨¡å—--> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-json</artifactId> </dependency> </dependencies> <build> <plugins> <plugin> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-maven-plugin</artifactId> <configuration> <excludes> <exclude> <groupId>org.projectlombok</groupId> <artifactId>lombok</artifactId> </exclude> </excludes> </configuration> </plugin> </plugins> </build> </project>
```

### åè®°

ä»Šå¤©ç»™å¤§å®¶å¸¦æ¥çš„æ˜¯å¦‚ä½•å®ç°ä¸€ä¸ªæ³¨è§£è¿›è¡Œæ•°æ®è„±æ•ã€‚

ä½ å¯ä»¥å­¦ä¹ åˆ°å¦‚ä½•ä½¿ç”¨hutoolå·¥å…·ç±»è¿›è¡Œæ•°æ®è„±æ•ã€‚

ä½ å¯ä»¥å­¦åˆ°å¦‚ä½•ä½¿ç”¨@JsonSerializeæ³¨è§£å®ç°è‡ªå®šä¹‰åºåˆ—åŒ–ã€‚

ä½ å¯ä»¥å­¦åˆ°å¦‚ä½•ä½¿ç”¨hutoolå·¥å…·+Jacksonå®ç°è‡ªå·±çš„è„±æ•æ³¨è§£ã€‚

æºç ï¼š[github.com/hujiaqing78â€¦](https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fhujiaqing789%2Fspring-boot-study.git "https://github.com/hujiaqing789/spring-boot-study.git")

**å¦‚æœä½ æœ‰é—®é¢˜æˆ–è€…å»ºè®®æ¬¢è¿å¤§å®¶è¯„è®ºåŒºè®¨è®ºã€‚**

**å¦‚å¯¹æ‚¨æœ‰ç”¨ï¼Œå¸Œæœ›ä½ å¯ä»¥ç‚¹èµï¼Œæ”¶è—ï¼Œè¯„è®ºï¼Œæ‚¨çš„æ”¯æŒæ˜¯æˆ‘æœ€å¤§åŠ¨åŠ›ã€‚**

**æˆ‘ä»¬ä¸‹æœŸå†è§ã€‚**

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5960e8830bf4dbd81c0a2c50e4dce72~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp)

******